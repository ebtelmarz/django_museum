




# Museum project

This project is an assignment for *Advanced Topics in Computer Science course* in **Roma Tre University**.

### Introduction

This project aims to work on a few datasets generated by devices that Hecht Museum visitors used during their visit.
The goal is to build an interface to display on a map how people moved inside the museum, and plotting some statistic graph.

Datasets that was available for us was:
- A log of visitors, showing where they was, when, and what they did.
- Informations on each point of interest inside museum

### How our team worked

The team which developed this app has a size of 2 people.
First of all we discussed about the data we have, the functional requirements, and our competences on technologies.
This discussion produced a todo-list from where each of us picked up a functionality, developed it, and pushed it on git repository as full stack developers.
Marte Valerio dedicated on the statistics functionality, deployment environment (with provisioning), installation instructions, and user manual.
Ebt developed upload functionality, data import from datasets functionality, map positioning, and visitor summarization.

## Setup and usage

This section explains how to install this project on a machine virtual machine, how to execute it, and how to interact with the involved software.

### Prerequisites

- [Vagrant](https://www.vagrantup.com/downloads.html) (stable version for this project is **2.2.4**)
- [Oracle VirtualBox](https://www.virtualbox.org/wiki/Downloads) (stable version for this project is **6.0.8**)

### What to do after git clone
1. Open a terminal in the repository main folder.
2. Move inside **environment** directory.
3. `vagrant up`.
4. Wait for Virtual Machine to configure (this may take a few minutes).
5. If everything is ok, you can see a message that says *museum node configuration complete* when process terminates.

### How to run the server?
1. `vagrant ssh`.
2. cd django_museum
3. `sh start-museum-app.sh`.

If everything is ok, now you whould see Django server logs in follow mode.

### I started the server, how can i interact with it?
Open your browser, and type localhost:[*http-port*](#port-forwarding)

### Interacting with virtual machine
- You can interact with virtual machine using `vagrant ssh`.
- You can shut down virtual machine by typing `vagrant halt` .
- You can remove this virtual machine by typing `vagrant destroy` .
- You can check your virtual machine status by typing `vagrant status` .
- Any other action can be checked typing `vagrant help`  or, to have a more detailed explaination, browsing [vagrant documentation](https://www.vagrantup.com/docs/).

### How ports are forwarded between virtual machine and host?
Ports are dynamically assigned every time you run `vagrant up`.
`vagrant port` shows you a list of port forwarding between virtual machine and host.

### <a name="port-forwarding"></a>How can i interact with MySQL database?
You can connect to database using a MySQL client (like [MySQL workbench](https://dev.mysql.com/downloads/workbench/)) and by using:

- Hostname: localhost
- Port: [*mysql-port*](#port-forwarding)

## Technological details

This section explains technological details about the project.

### Overall architecture

Architectural pattern used is **MVC** (Model View Controller), Django Framework is an implementation of it.

Django View layer
An SPA (Single Page Application) implementation: the application has a base HTML page in which we dinamically load HTML templates.
You can find templates in museum/templates.

Django Controller layer
As the pattern says: each template has a controller who retrieves the data requested by template.
You can find controller in views.py.

Django Model layer
We used a code first functionality in Django that allowed us to write Models in python, and just execute a couple of commands to create the database schema (migration process).

#### Deployment environment

The deployment environment is a virtual machine built by a VAGRANTFILE script, using vagrant, and virtualbox.
Vagrant provisioning functionality allows to self-install all the software required for the execution.

This software is required for project execution, and is listed as follow:
- Python 3.6.9
- Django framework 3.0.5
- MySQL

### Database

This schema is the result of a discussion for building the database:

![Schema](https://i.ibb.co/mGhjwBf/ATCS-Museumdrawio.jpg)
## User manual

This section explains how to use this app functionalities.

### Home page

Home page is dedicated for choosing the functionality you want to use.

#### Upload

In the homepage you can upload visitors log csv files. These csv logs have to respect a format, for example the file name has to be visitor_x_y.csv where x is the visitor id, and y is the group id.

Here is an example of how the data inside this csv has to be structured

```c

Positions 
14:50:29,14:52:15,EntranceReubenHecht
14:52:22,14:52:27,SymbolsJewishMenorah
14:52:32,14:54:11,PersianCult

presentations 
14:50:29,14:52:15,EntranceReubenHecht,129,System,3,-3
14:52:53,14:54:11,PersianCult,311,System,5,-3
14:55:16,14:56:29,MaterialCultures,165,System,5,-3
14:59:05,14:59:56,LeadCoffinMosaic,197,System,5,-3

events 
14:50:23,chosenExhibit,40
14:52:45,chosenExhibit,92
14:52:45,return from screen
14:55:08,return from screen
14:55:08,chosenExhibit,91
14:58:55,chosenExhibit,63
15:02:03,chosenExhibit,62

```

#### Refresh

*The refresh button starts a database crowding process that can require a few minutes.*

This process checks every csv file in the media/logs directory. The scope is to check if the visitor, and all the metadata inside visitor log, exists in the database. If not, the system will import all the data in the database.

### Statistics

The statistics functionality provides a view in which you can see some charts about data in the database. These data are dinamically calculated, so if you don't load data in the database, you'll not see statistics.
On the top of each chart are shown data labels. By clicking on these labels, you can activate/deactivate the rendering for label related data. By hovering the mouse on a data region in the chart, you'll see label name, and quantity. 
